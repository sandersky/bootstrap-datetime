!function(){function a(){var a=jQuery('input[type="date"], input[type="datetime"], input[type="time"]');a.wrap('<div class="input-group"></div>'),a.each(function(a,b){b=jQuery(b);var c;switch(b.attr("type")){case"date":b.data("type","date"),c='<button class="btn btn-default" type="button"><span class="glyphicon glyphicon-calendar"></span></button>';break;case"time":b.data("type","time"),c='<button class="btn btn-default" type="button"><span class="glyphicon glyphicon-time"></span></button>';break;default:b.data("type","datetime"),c='<button class="btn btn-default" type="button"><span class="glyphicon glyphicon-calendar"></span></button>'}b.after(jQuery('<div class="input-group-btn">'+c+"</div>")),b.parent().find("button").click(k)}),a.attr("type","text")}function b(a){u.find('[data-id="time-btn"]').removeClass("active"),u.find('[data-id="date-btn"]').addClass("active"),u.find('[data-id="time-content"]').hide(),u.find('.popover-title, [data-id="date-content"], [data-id="today-btn"]').show(),t=a.month(),y=a.year();var b=moment(a).startOf("month"),c=moment(a).endOf("month");x.text(moment.months()[t]+" "+y);var d,e=0,g="<tr>";for(d=0;d<b.day();d++)g+="<td></td>",e++;for(d=0;d<c.date();d++)7==e&&(g+="</tr><tr>",e=0),active=t===r.month()&&y===r.year()&&d+1===r.date()?"btn btn-xs btn-default active":"",g+='<td><a class="'+active+'" href="#">'+(d+1)+"</a></td>",e++;for(d=c.day();6>d;d++)g+="<td></td>",e++;g+="</tr>",w.html(jQuery(g)),w.find("a").click(f)}function c(){u=jQuery('<div class="popover bottom datetime-popover"><div class="arrow"></div><div class="popover-title text-center"><a data-id="previous-btn" class="btn btn-xs btn-default" href="#"><span class="glyphicon glyphicon-chevron-left"></span></a><h3 class="panel-title"></h3><a data-id="next-btn" class="btn btn-xs btn-default" href="#"><span class="glyphicon glyphicon-chevron-right"></span></a></div><div data-id="date-content" class="popover-content"><table class="table table-condensed table-striped"><thead><tr></tr></thead><tbody></tbody></table></div><div data-id="time-content" class="popover-content"></div><div class="panel-footer"><a data-id="today-btn" class="btn btn-xs btn-default" href="#">'+C+'</a><div data-id="datetime-btns" class="btn-group btn-group-xs pull-right"><a data-id="date-btn" class="btn btn-default active" href="#"><span class="glyphicon glyphicon-calendar"></span></a><a data-id="time-btn" class="btn btn-default" href="#"><span class="glyphicon glyphicon-time"></span></a></div><div class="clearfix"></div></div></div>'),u.find('[data-id="previous-btn"]').click(m),u.find('[data-id="next-btn"]').click(j),u.find('[data-id="today-btn"]').click(p),u.find('[data-id="date-btn"]').click(e),u.find('[data-id="time-btn"]').click(o);var a=u.find(".popover-content > table > thead > tr");for(var b in moment.weekdaysShort())a.append(jQuery("<th>"+moment.weekdaysShort()[b]+"</th>"));x=u.find(".panel-title"),w=u.find(".popover-content > table > tbody")}function d(){u.find('[data-id="date-btn"]').removeClass("active"),u.find('[data-id="time-btn"]').addClass("active"),u.find('.popover-title, [data-id="date-content"], [data-id="today-btn"]').hide(),u.find('[data-id="time-content"]').show()}function e(a){a.preventDefault();var c=jQuery(this);c.hasClass("active")||(b(r),c.siblings(".active").removeClass("active"),c.addClass("active"))}function f(a){a.preventDefault();var b=parseInt(jQuery(this).text()),c=moment(y+"-"+(t+1).toString().lpad("0",2)+"-"+b.toString().lpad("0",2));q(c)}function g(){u.find('[data-id="datetime-btns"]').hide()}function h(){u.hide(),v=null}function i(a){var b=a.keyCode||a.which;9===b&&(a.preventDefault(),"time"!==s.data("type")&&u.find('[data-id="previous-btn"]').focus())}function j(a){a.preventDefault();var c=t+2,d=y;12===t&&(d++,c=0);var e=moment(d.toString().lpad("0",4)+"-"+c.toString().lpad("0",2)+"-01");b(e)}function k(){if(s=jQuery(this).parent().prev(),v&&this===v)return h(),void jQuery(this).off("keydown",i);jQuery(this).on("keydown",i),v=this,s.after(u);var a=moment(s.val());a.isValid()||(a=moment()),r=a,l(a),u.show()}function l(a){switch(s.data("type")){case"date":g(),b(a);break;case"time":g(),d(a);break;default:n(),b(a)}}function m(a){a.preventDefault();var c=t,d=y;-1==t&&(d--,c=11);var e=moment(d.toString().lpad("0",4)+"-"+c.toString().lpad("0",2)+"-01");b(e)}function n(){u.find('[data-id="datetime-btns"]').show()}function o(a){a.preventDefault();var b=jQuery(this);b.hasClass("active")||(d(r),b.siblings(".active").removeClass("active"),b.addClass("active"))}function p(a){a.preventDefault();var b=moment();q(b)}function q(a){var b=moment(s.val());switch(b.isValid()?(a.hour(b.hour()),a.minute(b.minute()),a.second(b.second())):(a.hour(0),a.minute(0),a.second(0)),r=a,s.data("type")){case"date":s.val(a.format(z));break;case"time":s.val(a.format(B));break;default:s.val(a.format(A))}w.find(".active").removeClass("active"),w.find('a:textEquals("'+a.date()+'")').addClass("active"),"date"===s.data("type")?h():d(r)}var r,s,t,u,v,w,x,y,z="YYYY-MM-DD",A="YYYY-MM-DD HH:mm:ss",B="HH:mm:ss";jQuery.expr[":"].textEquals=function(a,b,c){return jQuery(a).text().match("^"+c[3]+"$")},String.prototype.lpad=function(a,b){for(var c=this;c.length<b;)c=a+c;return c};var C="Today";c(),jQuery(function(){jQuery("body").append(u),a()})}();